###############################################################################
# Copyright (c) 2017 Glenn McKechnie <glenn.mckechnie@gmail.com>              #
# With credit to Tom Keffer <tkeffer@gmail.com>                               #
#                                                                             #
# SQLBACKUP CONFIGURATION FILE                                                #
#  This 'report' generates gzipped sql files backup files from a running      #
#  weewx database.                                                            #
#                                                                             #
###############################################################################
#
# Report timing:
# see http://www.weewx.com/docs/customizing.htm#customizing_gen_time
#
#   2 min after midnight
report_timing = '2 0 * * *'

# First time? Need a refresher? There's a README.md file in the skins directory
# or sqlbackup/sqlbackupREADME.html on your web server for detailed instructions.

[sqlbackup] # This section heading is all lower case to enable skin duplication.

        #sql_user = "your_user_if_different_to_weewx.conf"
        # default is preset as localhost
        #sql_host = "localhost"
        # default is preset as weewx
        #sql_pass = "your_password_if_different_to_weewx.conf"

        # default database is read from weewx.conf. Can be overidden here.
        # Use a space seperated list for multiple databases.
        #mysql_database = "weatherpi mesoraw"
        #sql_database = "pmon.sdb weewx.sdb"

        # default is preset as 'archive' Change to '' to dump the dailies as well.
        # The daily tables get rebuilt when weewx restarts so we ignore them.
        #sql_table = ""
        # default is preset as /var/backups
        mysql_bup_dir = "/opt/backups/mysql-backups"
        # default is preset as /var/backups
        sql_bup_dir = "/opt/backups/sql-backups"
        # a dated_dir structure is preset to "True" To disable uncomment the
        # following
        #sql_dated_dir = 'False'

        # generate a summary report for the last run. Useful for obvious errors,
        # not useful for serious testing - test your backups to ensure they
        # actually do what you want!
        # Default is preset to "True" To disable uncomment the following line.
        #sql_gen_report = 'False'

        # these need to match, and the user needs do it for now
        # 86400 seconds = 24 hours # 604800 seconds = 7 days
        # This will be increased by 900 seconds (86400 + 900) to ensure backups
        # overlap
        #sql_period = "604800" # time in seconds ('86400' is the default setting)
         ##sql_period = "1262264400" # time in seconds (2 years)
        #sql_label = "7days" # meaningful string for the filename, use text to
        # match your sql_period ('daily' is default)
         ##sql_label = "2years" # meaningful string for the filename ('daily'
        # is the default)

        # Originally the sqlite databases were dumped in their entirety. This
        # could place an excessive load on weewx. The default now is to always
        # do partial dumps - True. Set to False for initial, full backups only?
        # Use with discretion.
        #part_sqlite = 'False'

        # Default is preset to "0" so commenting it out will disable DEBUG logging
        # from this skin (will also log when weewx.conf debug is set to "2")
        # Set sql_debug to "2" for extra DEBUG info in the logs.
        # Set sql_debug to "4" for extra DEBUG info in the report page
        # sqlbackup/index.html
        sql_debug = "4"
###############################################################################

[CheetahGenerator]
    # The CheetahGenerator creates files from templates.  This section
    # specifies which files will be generated from which template.

    # Possible encodings are 'html_entities', 'utf8', or 'strict_ascii'
    encoding = html_entities

    search_list_extensions = user.sqlbackup.SqlBackup

    [[ToDate]]
        # Reports that show statistics "to date", such as day-to-date,
        # week-to-date, month-to-date, etc.
        [[[index]]]
            template = index.html.tmpl

###############################################################################

[CopyGenerator]
    # The CopyGenerator copies files from one location to another.

    # List of files to be copied only the first time the generator runs
    copy_once = sqlbackup.css, sqlbackupREADME.html

    # List of files to be copied each time the generator runs
    # copy_always =

###############################################################################

[Generators]
    generator_list = weewx.cheetahgenerator.CheetahGenerator, weewx.reportengine.CopyGenerator
###############################################################################
# Copyright (c) 2010 Tom Keffer <tkeffer@gmail.com>                           #
# STANDARD SKIN CONFIGURATION FILE                                            #
###############################################################################

# reminders of date conversion from shell prompt.
#
# date -d "11-june-2017 21:00:00" +'%s'
# 1497178800
#
