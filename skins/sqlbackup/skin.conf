###############################################################################
# Copyright (c) 2017 Glenn McKechnie <glenn.mckechnie@gmail.com>              #
# With credit to Tom Keffer <tkeffer@gmail.com>                               #
#                                                                             #
# MYSQLDUMP CONFIGURATION FILE                                                #
#   This 'report' generates gzipped backup files from a running weewx         #
#  database. It doesn't generate any pages at the moment, however generating  #
#  a report on it's success or otherwise would be useful. One day...          #
#                                                                             #
###############################################################################
#
# Report timing - see http://www.weewx.com/docs/customizing.htm#customizing_gen_time
#
#  4 min after, every 6 hours
#report_timing  = '4 */6 * * *'
#   20 min after, every hour
report_timing = '51 */1 * * *'
#report_timing = '*/1 * * * *'
#report_timing = '@daily'

# First time? Need a refresher? There's a README.md file in the skins directory for
# detailed instructions.

[SqlBackup]
        #sql_user = "your_user_if_different_to_weewx.conf"
        # default is preset as localhost
        #sql_host = "localhost"
        # default is preset as weewx
        #sql_pass = "your_password_if_different_to_weewx.conf"

        # default database is read from weewx.conf. Can be overidden here. Specify here
        # for multiple databases
        #mysql_database = "weatherpi mesoraw"
        #sql_database = "pmon weewx"

        # default is preset as '' (none) which will do the dailies as well. Not used for
        # sqlite.
        sql_table = "archive"
        # default is preset as /var/backups
        mysql_bup_dir = "/opt/backups/mysql-backups"
        # default is preset as /var/backups
        sql_bup_dir = "/opt/backups/sql-backups"
        # a dated_dir structure is preset to "True" To disable uncomment the following
        #sql_dated_dir = 'False'

        # generate a summary report for the last run. Useful for obvious errors, not useful
        # for serious testing - test your backups to ensure they actually do what you want!
        # Default is preset to "True" To disable uncomment the following line.
        #sql_gen_report = 'False'
        # default is preset as /var/www/html/weewx (for Seasons or Standard skin)
        #html_root = "/var/www/html/weewx"

        # these need to match, and the user needs do it for now
        # 86400 seconds = 24 hours # 604800 seconds = 7 days
        # This will be increased by 900 seconds (86400 + 900) to ensure backups overlap
        #sql_tperiod = "604800" # time in seconds ('86400' is the default setting)
         ###sql_tperiod = "1262264400" # time in seconds ('86400' is the default setting)
        #sql_tlabel = "7days" # meaningful string for the filename ('daily' is default)
         ###sql_tlabel = "allofit" # meaningful string for the filename ('daily' is default)

        # Default is preset to "0" so commenting it out will disable DEBUG logging from this skin
        # (will also log when weewx.conf debug is set to "2") 
        # Set sql_debug to "2" for extra DEBUG info in the logs.
        # Set sql_debug to "4" for extra DEBUG info in the report page - sqlbackup.html
        sql_debug = "5"
###############################################################################

[CheetahGenerator]
    # The CheetahGenerator creates files from templates.  This section
    # specifies which files will be generated from which template.

    # Possible encodings are 'html_entities', 'utf8', or 'strict_ascii'
    encoding = html_entities

    search_list_extensions = user.sqlbackup.SqlBackup

    [[ToDate]]
        # Reports that show statistics "to date", such as day-to-date,
        # week-to-date, month-to-date, etc.
        [[[index]]]
            template = sqlbackup.html.tmpl

###############################################################################

[CopyGenerator]
    # The CopyGenerator copies files from one location to another.

    # List of files to be copied only the first time the generator runs
    copy_once = sqlbackupREADME.html

    # List of files to be copied each time the generator runs
    # copy_always =

###############################################################################

[Generators]
    generator_list = weewx.cheetahgenerator.CheetahGenerator, weewx.reportengine.CopyGenerator
###############################################################################
# Copyright (c) 2010 Tom Keffer <tkeffer@gmail.com>                           #
# STANDARD SKIN CONFIGURATION FILE                                            #
###############################################################################

# reminders of date conversion from shell prompt.
#
# date -d "11-june-2017 21:00:00" +'%s'
# 1497178800
#
